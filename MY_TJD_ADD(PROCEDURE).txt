MY_TJD_ADD	PROCEDURE	1	"PROCEDURE         ""MY_TJD_ADD"" 
"
MY_TJD_ADD	PROCEDURE	2	" IS 
"
MY_TJD_ADD	PROCEDURE	3	" BEGIN 
"
MY_TJD_ADD	PROCEDURE	4	" DECLARE 
"
MY_TJD_ADD	PROCEDURE	5	"    ls_crkdh       VARCHAR2(10); 
"
MY_TJD_ADD	PROCEDURE	6	"    li_xtxh        NUMBER(2); 
"
MY_TJD_ADD	PROCEDURE	7	" 	LD_RQ          DATE; 
"
MY_TJD_ADD	PROCEDURE	8	" 	LD_KSRQ        DATE; 
"
MY_TJD_ADD	PROCEDURE	9	"    CURSOR CUR_YPMXZ_TJDH IS 
"
MY_TJD_ADD	PROCEDURE	10	"      select crkdh,xtxh from my_ypmxz where rq> ld_ksrq and crkdm in (33,83) 
"
MY_TJD_ADD	PROCEDURE	11	" 		 minus 
"
MY_TJD_ADD	PROCEDURE	12	" 	  select tjdh,xtxh from my_tjd; 
"
MY_TJD_ADD	PROCEDURE	13	" BEGIN 
"
MY_TJD_ADD	PROCEDURE	14	"   select trunc(sysdate - 2) into ld_ksrq from dual; 
"
MY_TJD_ADD	PROCEDURE	15	"    
"
MY_TJD_ADD	PROCEDURE	16	"   OPEN CUR_YPMXZ_TJDH; 
"
MY_TJD_ADD	PROCEDURE	17	"   LOOP 
"
MY_TJD_ADD	PROCEDURE	18	"        FETCH CUR_YPMXZ_TJDH INTO LS_CRKDH,LI_XTXH; 
"
MY_TJD_ADD	PROCEDURE	19	"        EXIT WHEN CUR_YPMXZ_TJDH%NOTFOUND; 
"
MY_TJD_ADD	PROCEDURE	20	" 		 
"
MY_TJD_ADD	PROCEDURE	21	" 		 SELECT RQ INTO LD_RQ 
"
MY_TJD_ADD	PROCEDURE	22	" 		   FROM MY_YPMXZ 
"
MY_TJD_ADD	PROCEDURE	23	" 		  WHERE RQ>ld_ksrq AND CRKDM IN (33,83) AND CRKDH=LS_CRKDH AND XTXH+0=LI_XTXH AND ROWNUM=1; 
"
MY_TJD_ADD	PROCEDURE	24	" 		 
"
MY_TJD_ADD	PROCEDURE	25	"        INSERT INTO MY_TJD (TJDH,TJWH,SJRQ,TJRQ,ZXRQ,ZXR,XTXH) 
"
MY_TJD_ADD	PROCEDURE	26	" 		             VALUES (LS_CRKDH,NULL,NULL,NULL,LD_RQ,NULL,LI_XTXH); 
"
MY_TJD_ADD	PROCEDURE	27	"        
"
MY_TJD_ADD	PROCEDURE	28	" 		 COMMIT; 
"
MY_TJD_ADD	PROCEDURE	29	" 	END LOOP; 
"
MY_TJD_ADD	PROCEDURE	30	"    CLOSE CUR_YPMXZ_TJDH; 
"
MY_TJD_ADD	PROCEDURE	31	"    
"
MY_TJD_ADD	PROCEDURE	32	" END ; 
"
MY_TJD_ADD	PROCEDURE	33	" END ; 
"
MY_TJD_ADD	PROCEDURE	34	 
