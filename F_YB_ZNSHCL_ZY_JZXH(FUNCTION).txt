F_YB_ZNSHCL_ZY_JZXH	FUNCTION	1	"FUNCTION f_yb_znshcl_zy_jzxh(in_patient_no number,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	2	"                                               in_jzxh       number)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	3	"  return varchar2 Is
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	4	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	5	"  v_data   varchar2(200);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	6	"  v_temp   varchar2(500);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	7	"  v_kz_msg varchar2(500);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	8	"  v_str2   varchar2(100);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	9	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	10	"  v_pos      number;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	11	"  v_flag     varchar2(50);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	12	"  v_flag_len number;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	13	"  v_sl       number;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	14	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	15	"  v_je     number;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	16	"  ll_count number;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	17	"  v_count  number;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	18	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	19	"  v_cfsb     number;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	20	"  v_cfk1_new number;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	21	"  v_jzkh     varchar(20);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	22	"  v_brxm     varchar(50);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	23	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	24	"  v_fypb number;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	25	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	26	"  arg_systime           varchar2(50);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	27	"  arg_patient_no        varchar2(20);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	28	"  arg_fygl              varchar2(20);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	29	"  arg_charge_code       varchar2(20);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	30	"  arg_sl                number;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	31	"  arg_dj                number;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	32	"  v_patient_no          number;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	33	"  arg_spbh              varchar2(20);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	34	"  arg_zx_ks             varchar2(20);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	35	"  arg_curr_ks           varchar2(20);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	36	"  arg_czgh              varchar2(20);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	37	"  arg_twice_detail_code varchar2(50);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	38	"  arg_charge_name       varchar2(50);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	39	"  arg_twice_detail_id   varchar2(50);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	40	"  arg_ysgh              varchar2(50);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	41	"  v_sfrq                varchar2(20);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	42	"  v_ybdm5               varchar2(200);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	43	"  v_ybdm                varchar2(200);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	44	"  v_ybdm_fl             varchar2(100);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	45	"  v_xmbh                varchar2(50);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	46	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	47	"  cursor cursor_znshbz5 is
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	48	"    select to_char(x.charge_date, 'yyyy-mm-dd'),
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	49	"           y.xmbh,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	50	"           y.shbz,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	51	"           nvl(y.kz_msg, y.shbz)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	52	"      From zy_detail_charge x, yb_znshgz y, yb_duizhaoml z
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	53	"     where y.xmbh = z.yibaodm
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	54	"       and z.xiangmuxh = x.charge_code
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	55	"       and z.xiangmucd = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	56	"       and z.tingyongrq is null
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	57	"       and z.yibaolx = '9997'
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	58	"       and y.gzbh = 5
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	59	"       and (nvl(x.spbh, 0) <> -10 and x.fygl > 3 and
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	60	"           x.twice_detail_code = 'BF' and x.jcfx_date > sysdate - 0.01 and
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	61	"           nvl(x.jzxh, 0) = in_jzxh or x.jlxh = -326502254)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	62	"       and x.patient_no = in_patient_no
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	63	"     group by to_char(x.charge_date, 'yyyy-mm-dd'),
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	64	"              y.xmbh,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	65	"              y.shbz,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	66	"              nvl(y.kz_msg, y.shbz)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	67	"    having sum(x.sl) > 0;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	68	"begin
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	69	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	70	"  --out_msg:='';
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	71	"  --insert into zy_jiaoyi_v1(jiaoyilx,jylsh) values (in_item,in_source);
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	72	"  --commit;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	73	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	74	"  --out_msg:='没有处理的内容';
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	75	"  -- v_temp:='123123';
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	76	"  /* if in_jcfx_date = '0' then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	77	"    v_temp := '123123';
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	78	"  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	79	"    insert into zy_jiaoyi_v1 (jiaoyilx, jylsh) values ('cs', 'cs');
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	80	"    commit;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	81	"    v_temp := '12341234';
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	82	"    return v_temp;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	83	"  end if;*/
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	84	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	85	"  --跳过存储过程控制
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	86	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	87	"  if 1 = 0 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	88	"    return '';
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	89	"  end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	90	"  v_patient_no := in_patient_no;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	91	"  if v_patient_no > 0 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	92	"    null;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	93	"  else
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	94	"    select 'patient_no<0,[f_yb_znshcl_zy_jzxh]' into v_temp from dual;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	95	"    Return v_temp;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	96	"  end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	97	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	98	"  -- t_pass_zy  病案号 放行
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	99	"  if 1 = 1 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	100	"    v_count := 0;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	101	"    select count(bah)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	102	"      into v_count
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	103	"      From t_pass_zy
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	104	"     where bah in (select bah
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	105	"                     from zy_patient_information
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	106	"                    where patient_no = in_patient_no)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	107	"       and czrq > sysdate - 0.1;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	108	"  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	109	"    if v_count >= 1 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	110	"    
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	111	"      return '';
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	112	"    end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	113	"  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	114	"  end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	115	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	116	"  --材料与项目不符
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	117	"  select to_char(sysdate, 'hh24') into v_temp from dual;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	118	"  if 5 = 5 and v_temp >= '07' and v_temp < '27' and in_patient_no = 870546 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	119	"  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	120	"    LOOP
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	121	"    
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	122	"      IF NOT cursor_znshbz5%ISOPEN THEN
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	123	"        --打开游标
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	124	"        OPEN cursor_znshbz5;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	125	"      END IF;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	126	"    
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	127	"      FETCH cursor_znshbz5
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	128	"        INTO v_sfrq, v_xmbh, v_ybdm5, v_kz_msg;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	129	"      --退出循环的条件
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	130	"      EXIT WHEN cursor_znshbz5%NOTFOUND OR cursor_znshbz5%NOTFOUND IS NULL;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	131	"    
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	132	"      if sqlcode <> 0 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	133	"        --关闭游标
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	134	"        close cursor_znshbz5;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	135	"      
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	136	"      end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	137	"      select v_ybdm5 || '^' into v_ybdm5 from dual;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	138	"      loop
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	139	"        select substr(v_ybdm5, 1, instr(v_ybdm5, '^') - 1)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	140	"          into v_ybdm
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	141	"          from dual;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	142	"        select substr(v_ybdm5, instr(v_ybdm5, '^') + 1)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	143	"          into v_ybdm5
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	144	"          from dual;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	145	"        if length(v_ybdm) > 1 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	146	"        
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	147	"          select substr(v_ybdm, 1, instr(v_ybdm, '分类下') - 1)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	148	"            into v_ybdm_fl
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	149	"            from dual;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	150	"          if length(v_ybdm_fl) > 1 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	151	"            v_ybdm := v_ybdm_fl;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	152	"          end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	153	"          select sum(x.sl)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	154	"            into v_sl
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	155	"            From zy_detail_charge x, yb_duizhaoml z
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	156	"           where z.xiangmuxh = x.charge_code
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	157	"             and z.xiangmucd = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	158	"             and z.tingyongrq is null
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	159	"             and z.yibaolx = '9997'
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	160	"             and instr(z.yibaodm, 'f' || v_ybdm) > 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	161	"             and x.fygl > 3
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	162	"             and to_char(x.charge_date, 'yyyy-mm-dd') = v_sfrq
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	163	"             and x.patient_no = in_patient_no;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	164	"          if v_sl > 0 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	165	"            exit;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	166	"          end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	167	"        
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	168	"          SELECT count(yibaodm)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	169	"            into v_sl
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	170	"            FROM yb_duizhaoml t
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	171	"           where instr(t.yibaodm, 'f' || v_ybdm) > 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	172	"             and nvl(tingyongrq, '20990101') > to_char(sysdate, 'yyyymmdd')
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	173	"             and yibaolx = '9997'
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	174	"             and t.yaopinpb = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	175	"             and t.xiangmuxh in
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	176	"                 (select ylxh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	177	"                    From yz_order_ylsf
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	178	"                   where order_code in
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	179	"                         (SELECT a.order_code
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	180	"                            FROM YZ_INPATIENT_ORDER A
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	181	"                           WHERE (a.""STATUS_FLAG"" in (2, 3))
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	182	"                             AND (a.""ORDER_FLAG"" in (1, 8, 9))
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	183	"                             AND (a.""STATUS"" in (2, 3, 4, 10))
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	184	"                             and a.djxh = in_patient_no));
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	185	"        
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	186	"          if v_sl > 0 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	187	"            exit;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	188	"          end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	189	"        
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	190	"        else
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	191	"        
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	192	"          exit;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	193	"        end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	194	"      
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	195	"      end loop;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	196	"      if v_sl > 0 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	197	"        null;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	198	"      else
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	199	"      
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	200	"        select nvl('  ' || v_sfrq || xmmc || '(' || gzmc || ') 需' ||
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	201	"                   v_kz_msg || '下使用' || '[f_yb_znshcl_zy_jzxh]',
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	202	"                   '')
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	203	"          into v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	204	"          from yb_znshgz
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	205	"         where xmbh = v_xmbh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	206	"           and gzbh = 5
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	207	"           and rownum = 1;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	208	"      
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	209	"        if length(v_temp) > 1 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	210	"          select curr_bed || '床,' || bah || v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	211	"            into v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	212	"            from zy_patient_information
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	213	"           where patient_no = in_patient_no;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	214	"        
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	215	"          Return v_temp;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	216	"        end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	217	"      
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	218	"      end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	219	"    
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	220	"    END LOOP;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	221	"  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	222	"  end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	223	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	224	"  -- end 材料与项目不符
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	225	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	226	"  --指定项目限频次 begin
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	227	"  if 1 = 1 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	228	"    select nvl(min(to_char(trunc(sysdate), 'yyyy-mm-dd ') || ylmc || '(' || ylxh ||
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	229	"                   ')单日总次数为 ' || zsl || '超过物价规定:' || kzsl_zy ||
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	230	"                   '[f_yb_znshcl_zy_jzxh]'),
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	231	"               '')
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	232	"      into v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	233	"      from (select trunc(sysdate), ylxh, ylmc, kzsl_zy, bz, sum(sl) zsl
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	234	"              from (select trunc(sysdate),
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	235	"                           b.ylxh,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	236	"                           b.ylmc,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	237	"                           b.kzsl_zy,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	238	"                           b.bz,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	239	"                           sum(a.sl) sl
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	240	"                      from zy_detail_charge a, v_yb_znshgz_zy b
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	241	"                     where a.charge_code = b.ylxh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	242	"                       and nvl(a.jzxh, 0) = in_jzxh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	243	"                       and trunc(charge_date) = trunc(sysdate)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	244	"                       and nvl(a.twice_detail_code, '0') <> 'ZY'
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	245	"                       and a.jzxh = in_jzxh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	246	"                       and a.jcfx_date > sysdate - 15
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	247	"                       and a.patient_No = in_patient_no
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	248	"                     group by trunc(sysdate), b.ylxh, b.ylmc, b.kzsl_zy, b.bz
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	249	"                    union all
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	250	"                    
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	251	"                    select trunc(sysdate),
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	252	"                           b.ylxh,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	253	"                           b.ylmc,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	254	"                           b.kzsl_zy,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	255	"                           b.bz,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	256	"                           sum(a.sl) sl
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	257	"                      from zy_detail_charge a, v_yb_znshgz_zy b
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	258	"                     where a.charge_code = b.ylxh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	259	"                       and trunc(charge_date) = trunc(sysdate)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	260	"                       and nvl(a.jzxh, 0) <> in_jzxh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	261	"                       and nvl(a.twice_detail_code, '0') <> 'ZY'
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	262	"                       and a.jcfx_date > sysdate - 15
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	263	"                       and a.patient_No = in_patient_no
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	264	"                     group by trunc(sysdate), b.ylxh, b.ylmc, b.kzsl_zy, b.bz
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	265	"                    
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	266	"                    )
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	267	"             group by trunc(sysdate), ylxh, ylmc, kzsl_zy, bz
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	268	"            having kzsl_zy < sum(sl)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	269	"            union all
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	270	"            select trunc(sysdate), 0, '', 0, '', 0 sl from dual)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	271	"     where ylxh > 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	272	"       and kzsl_zy > 0;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	273	"    if v_temp = null then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	274	"      v_temp := '';
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	275	"    end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	276	"  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	277	"    if length(v_temp) > 1 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	278	"    
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	279	"      select curr_bed || '床,' || bah || v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	280	"        into v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	281	"        from zy_patient_information
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	282	"       where patient_no = in_patient_no;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	283	"    
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	284	"      Return v_temp;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	285	"    end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	286	"  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	287	"  end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	288	"  --指定项目限频次 end 
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	289	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	290	"  --项目限频次 begin
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	291	"  if 1 = 1 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	292	"    select nvl(min(x1.xmmc || '[' || x1.xmbh || '],使用数量' || x1.sl_sum ||
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	293	"                   ',超过限定数量' || x1.kzsl_zy || '[f_yb_znshcl_zy_jzxh]'),
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	294	"               '')
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	295	"      INTO v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	296	"      from (select patient_no,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	297	"                   y.xmmc,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	298	"                   y.xmbh,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	299	"                   nvl(y.kzsl_zy, 0) kzsl_zy,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	300	"                   to_char(charge_date, 'yyyy-mm-dd') rq,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	301	"                   sum(sl) sl_sum
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	302	"              From zy_detail_charge x, yb_znshgz y, yb_duizhaoml z
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	303	"             where y.xmbh = z.yibaodm
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	304	"               and z.xiangmuxh = x.charge_code
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	305	"               and z.xiangmucd = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	306	"               and z.tingyongrq is null
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	307	"               and z.yibaolx = '9997'
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	308	"               and nvl(x.twice_detail_code, '0') <> 'ZY'
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	309	"               and y.gzbh = 7
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	310	"               and y.kzsl_zy > 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	311	"               and x.fygl > 3
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	312	"               and trunc(charge_date) = trunc(sysdate)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	313	"               and x.jcfx_date > sysdate - 15
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	314	"               and x.patient_no = in_patient_no
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	315	"             group by patient_no,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	316	"                      y.xmmc,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	317	"                      y.xmbh,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	318	"                      y.kzsl_zy,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	319	"                      to_char(charge_date, 'yyyy-mm-dd')
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	320	"            
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	321	"            having kzsl_zy < sum(sl)) x1,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	322	"           zy_detail_charge x2,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	323	"           yb_duizhaoml x3
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	324	"     where x1.xmbh = x3.yibaodm
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	325	"       and x3.xiangmuxh = x2.charge_code
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	326	"       and x3.xiangmucd = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	327	"       and x3.tingyongrq is null
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	328	"       and x3.yibaolx = '9997'
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	329	"       and nvl(x2.twice_detail_code, '0') <> 'ZY'
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	330	"       and x2.fygl > 3
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	331	"       and nvl(x2.jzxh, 0) = in_jzxh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	332	"       and x1.kzsl_zy > 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	333	"       and x2.jcfx_date > sysdate - 15
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	334	"       and x2.patient_no = in_patient_no;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	335	"  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	336	"    if length(v_temp) > 1 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	337	"      select curr_bed || '床,' || bah || v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	338	"        into v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	339	"        from zy_patient_information
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	340	"       where patient_no = in_patient_no;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	341	"    
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	342	"      Return v_temp;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	343	"    end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	344	"  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	345	"  end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	346	"  --项目限频次 end
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	347	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	348	"  -- 重复收费   begin
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	349	"  if 3 = 3 and v_patient_no > 0 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	350	"  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	351	"    select nvl(min(bz0 || '[' || sl0 || '];' || '[f_yb_znshcl_zy_jzxh]'),
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	352	"               '')
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	353	"      INTO v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	354	"      from (
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	355	"            -----
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	356	"            select aa.patient_no patient_no0,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	357	"                    aa.rq || ':' || aa.charge_name || '[' || sl_sum ||
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	358	"                    '],重复收费 ,与  ' || to_char(x1.charge_name) bz0,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	359	"                    sum(x1.sl) sl0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	360	"              from (select x.ZX_KS,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	361	"                            x.patient_no,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	362	"                            x.charge_name,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	363	"                            y.xmbh,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	364	"                            to_char(x.charge_date, 'yyyy-mm-dd') rq,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	365	"                            sum(x.sl) sl_sum
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	366	"                       From zy_detail_charge x, yb_znshgz y, yb_duizhaoml z
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	367	"                      where y.xmbh = z.yibaodm
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	368	"                        and z.xiangmuxh = x.charge_code
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	369	"                        and x.fygl > 3
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	370	"                        and z.xiangmucd = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	371	"                        and z.yibaolx = '9997'
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	372	"                           --  and x.ybdm = y.xmbh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	373	"                        and y.gzbh = 8
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	374	"                        and x.jcfx_date > sysdate - 15
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	375	"                        and x.patient_no = v_patient_no
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	376	"                      group by x.ZX_KS,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	377	"                               x.patient_no,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	378	"                               x.charge_name,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	379	"                               y.xmbh,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	380	"                               to_char(x.charge_date, 'yyyy-mm-dd')) aa,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	381	"                    zy_detail_charge x1,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	382	"                    yb_znshgz y1,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	383	"                    yb_duizhaoml z1
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	384	"             where aa.patient_no = x1.patient_no
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	385	"                  -- and aa.charge_name = x1.charge_name
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	386	"                  -- and aa.xmbh <> z1.yibaodm
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	387	"               and aa.ZX_KS = x1.ZX_KS
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	388	"               and aa.rq = to_char(x1.charge_date, 'yyyy-mm-dd')
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	389	"               and aa.sl_sum > 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	390	"               and nvl(x1.jzxh, 0) = in_jzxh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	391	"               and z1.xiangmuxh = x1.charge_code
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	392	"               and x1.fygl > 3
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	393	"               and z1.xiangmucd = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	394	"               and z1.yibaolx = '9997'
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	395	"               and y1.gzbh = 8
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	396	"               and aa.xmbh = y1.xmbh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	397	"               and instr(y1.shbz, z1.yibaodm) > 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	398	"               and aa.sl_sum > 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	399	"               and x1.jcfx_date > sysdate - 15
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	400	"               and x1.patient_no = v_patient_no
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	401	"             group by aa.patient_no,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	402	"                       aa.rq || ':' || aa.charge_name || '[' || sl_sum ||
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	403	"                       '],重复收费 ,与  ' || to_char(x1.charge_name)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	404	"            ---           
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	405	"            )
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	406	"     where sl0 > 0;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	407	"    if length(v_temp) > 1 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	408	"      select curr_bed || '床,' || bah || v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	409	"        into v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	410	"        from zy_patient_information
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	411	"       where patient_no = in_patient_no;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	412	"    
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	413	"      Return v_temp;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	414	"    end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	415	"  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	416	"    if 1 = 1 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	417	"      select nvl(min(bz0 || '[' || sl0 || '];' || '[f_yb_znshcl_zy_jzxh]'),
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	418	"                 '')
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	419	"        INTO v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	420	"        from (
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	421	"              -----
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	422	"              select aa.patient_no patient_no0,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	423	"                      aa.rq || ':' || aa.charge_name || '[' || sl_sum ||
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	424	"                      '],重复收费 ,与  ' || to_char(x1.charge_name) bz0,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	425	"                      sum(x1.sl) sl0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	426	"                from (select x.ZX_KS,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	427	"                              x.patient_no,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	428	"                              x.charge_name,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	429	"                              y.xmbh,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	430	"                              to_char(x.charge_date, 'yyyy-mm-dd') rq,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	431	"                              sum(x.sl) sl_sum
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	432	"                         From zy_detail_charge x, yb_znshgz y, yb_duizhaoml z
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	433	"                        where y.xmbh = z.yibaodm
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	434	"                          and z.xiangmuxh = x.charge_code
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	435	"                          and nvl(x.jzxh, 0) = in_jzxh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	436	"                          and x.fygl > 3
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	437	"                          and z.xiangmucd = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	438	"                          and z.yibaolx = '9997'
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	439	"                             --  and x.ybdm = y.xmbh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	440	"                          and y.gzbh = 8
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	441	"                          and x.js_no = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	442	"                          and x.INFANT_FLAG = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	443	"                          and x.patient_no in (v_patient_no)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	444	"                        group by x.ZX_KS,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	445	"                                 x.patient_no,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	446	"                                 x.charge_name,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	447	"                                 y.xmbh,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	448	"                                 to_char(x.charge_date, 'yyyy-mm-dd')) aa,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	449	"                      zy_detail_charge x1,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	450	"                      yb_znshgz y1,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	451	"                      yb_duizhaoml z1
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	452	"               where aa.patient_no = x1.patient_no
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	453	"                    -- and aa.charge_name = x1.charge_name
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	454	"                    -- and aa.xmbh <> z1.yibaodm
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	455	"                 and aa.ZX_KS = x1.ZX_KS
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	456	"                 and aa.rq = to_char(x1.charge_date, 'yyyy-mm-dd')
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	457	"                 and aa.sl_sum > 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	458	"                    
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	459	"                 and z1.xiangmuxh = x1.charge_code
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	460	"                 and x1.fygl > 3
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	461	"                 and z1.xiangmucd = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	462	"                 and z1.yibaolx = '9997'
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	463	"                 and y1.gzbh = 8
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	464	"                 and aa.xmbh = y1.xmbh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	465	"                 and instr(y1.shbz, z1.yibaodm) > 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	466	"                 and aa.sl_sum > 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	467	"                 and x1.js_no = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	468	"                 and x1.INFANT_FLAG = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	469	"                 and x1.patient_no in (v_patient_no)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	470	"               group by aa.patient_no,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	471	"                         aa.rq || ':' || aa.charge_name || '[' || sl_sum ||
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	472	"                         '],重复收费 ,与  ' || to_char(x1.charge_name)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	473	"              ---           
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	474	"              )
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	475	"       where sl0 > 0;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	476	"      if length(v_temp) > 1 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	477	"        select curr_bed || '床,' || bah || v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	478	"          into v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	479	"          from zy_patient_information
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	480	"         where patient_no = in_patient_no;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	481	"      
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	482	"        Return v_temp;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	483	"      end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	484	"    end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	485	"  end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	486	"  -- 重复收费   end 
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	487	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	488	"  --项目限性别 begin
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	489	"  if 1 = 1 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	490	"    select nvl(min(e.xmmc || '不符合规定性别使用 [f_yb_znshcl_zy_jzxh]'),
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	491	"               '')
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	492	"      into v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	493	"      from zy_detail_charge       a,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	494	"           yb_znshgz              e,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	495	"           yb_duizhaoml           d,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	496	"           zy_patient_information c
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	497	"     where d.yibaodm = e.xmbh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	498	"       and substr(d.yibaodm, 1, 12) = substr(e.xmbh, 1, 12)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	499	"       and nvl(a.jzxh, 0) = in_jzxh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	500	"       and e.gzbh = 6
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	501	"       and e.ypzlpb = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	502	"       and a.patient_no = c.patient_no
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	503	"       and a.js_no = c.js_no
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	504	"       and a.infant_flag = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	505	"       and a.charge_code = d.xiangmuxh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	506	"       and d.yaopinpb = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	507	"       and a.fygl > 3
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	508	"       and substr(d.yibaodm, 1, 12) in
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	509	"           (select substr(xmbh, 1, 12)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	510	"              From yb_znshgz t1, zy_patient_information t2
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	511	"             where ((t1.shbz = '女' and nvl(t2.sex, 1) = 1) or
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	512	"                   (t1.shbz = '男' and nvl(t2.sex, 1) = 2))
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	513	"                  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	514	"               and t1.gzbh = 6
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	515	"               and nvl(t1.ypzlpb, 0) = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	516	"               and t2.patient_no = in_patient_no)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	517	"       and d.yibaolx = '9997'
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	518	"       and d.tingyongrq is null
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	519	"       and a.js_no = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	520	"       and a.jcfx_date > sysdate - 7
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	521	"       and c.patient_No = in_patient_no
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	522	"       and a.patient_No = in_patient_no;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	523	"  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	524	"    if length(v_temp) > 1 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	525	"      select curr_bed || '床,' || bah || v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	526	"        into v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	527	"        from zy_patient_information
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	528	"       where patient_no = in_patient_no;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	529	"    
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	530	"      Return v_temp;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	531	"    end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	532	"  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	533	"  end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	534	"  --项目限性别 end
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	535	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	536	"  --放行，仅仅提示
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	537	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	538	"  --项目限14周岁begin
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	539	"  if 1 = 0 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	540	"    select nvl(min(e.xmmc || '限儿童14周岁使用 [f_yb_znshcl_zy_jzxh][不控制]'),
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	541	"               '')
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	542	"      into v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	543	"      from zy_detail_charge       a,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	544	"           yb_znshgz              e,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	545	"           yb_duizhaoml           d,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	546	"           zy_patient_information c
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	547	"     where d.yibaodm = e.xmbh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	548	"       and substr(d.yibaodm, 1, 12) = substr(e.xmbh, 1, 12)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	549	"       and nvl(a.jzxh, 0) = in_jzxh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	550	"       and e.gzbh = 4
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	551	"       and (instr(e.shbz, '14周岁') > 0)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	552	"       and e.ypzlpb = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	553	"       and nvl(a.spbh, 0) <> -10
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	554	"       and a.patient_no = c.patient_no
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	555	"       and a.js_no = c.js_no
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	556	"       and a.infant_flag = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	557	"       and a.charge_code = d.xiangmuxh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	558	"       and d.yaopinpb = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	559	"       and a.fygl > 3
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	560	"       and d.yibaolx = '9997'
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	561	"       and d.tingyongrq is null
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	562	"       and a.js_no = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	563	"       and (sysdate - nvl(c.birthday, sysdate)) > 5110
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	564	"       and a.patient_No = in_patient_no;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	565	"  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	566	"    if length(v_temp) > 1 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	567	"      select curr_bed || '床,' || bah || v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	568	"        into v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	569	"        from zy_patient_information
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	570	"       where patient_no = in_patient_no;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	571	"    
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	572	"      Return v_temp;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	573	"    end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	574	"  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	575	"  end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	576	"  --限14周岁 end
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	577	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	578	"  --项目限6周岁begin
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	579	"  if 1 = 0 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	580	"    select nvl(min(e.xmmc || '限儿童6周岁使用 [F_YB_ZNSHCL_ZY_JZXH][不控制]'),
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	581	"               '')
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	582	"      into v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	583	"      from zy_detail_charge       a,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	584	"           yb_znshgz              e,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	585	"           yb_duizhaoml           d,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	586	"           zy_patient_information c
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	587	"     where d.yibaodm = e.xmbh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	588	"       and substr(d.yibaodm, 1, 12) = substr(e.xmbh, 1, 12)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	589	"       and nvl(a.jzxh, 0) = in_jzxh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	590	"       and e.gzbh = 4
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	591	"       and (instr(e.shbz, '6周岁') > 0)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	592	"       and e.ypzlpb = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	593	"       and nvl(a.spbh, 0) <> -10
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	594	"       and a.patient_no = c.patient_no
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	595	"       and a.js_no = c.js_no
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	596	"       and a.infant_flag = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	597	"       and a.charge_code = d.xiangmuxh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	598	"       and d.yaopinpb = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	599	"       and a.fygl > 3
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	600	"       and (sysdate - nvl(c.birthday, sysdate)) > 2190
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	601	"       and d.yibaolx = '9997'
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	602	"       and d.tingyongrq is null
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	603	"       and a.js_no = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	604	"       and a.patient_No = in_patient_no;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	605	"  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	606	"    if length(v_temp) > 1 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	607	"      select curr_bed || '床,' || bah || v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	608	"        into v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	609	"        from zy_patient_information
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	610	"       where patient_no = in_patient_no;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	611	"    
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	612	"      Return v_temp;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	613	"    end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	614	"  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	615	"  end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	616	"  --限6周岁 end
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	617	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	618	"  --项目限28天 begin
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	619	"  if 1 = 0 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	620	"    select nvl(min(e.xmmc || '限儿童28天使用 [F_YB_ZNSHCL_ZY_JZXH][不控制]'),
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	621	"               '')
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	622	"      into v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	623	"      from zy_detail_charge       a,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	624	"           yb_znshgz              e,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	625	"           yb_duizhaoml           d,
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	626	"           zy_patient_information c
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	627	"     where d.yibaodm = e.xmbh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	628	"       and substr(d.yibaodm, 1, 12) = substr(e.xmbh, 1, 12)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	629	"       and nvl(a.jzxh, 0) = in_jzxh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	630	"       and e.gzbh = 4
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	631	"       and (instr(e.shbz, '28天') > 0)
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	632	"       and e.ypzlpb = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	633	"       and a.patient_no = c.patient_no
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	634	"       and a.js_no = c.js_no
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	635	"       and a.infant_flag = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	636	"       and nvl(a.spbh, 0) <> -10
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	637	"       and a.charge_code = d.xiangmuxh
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	638	"       and d.yaopinpb = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	639	"       and a.fygl > 3
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	640	"       and (sysdate - nvl(c.birthday, sysdate)) > 28
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	641	"       and d.yibaolx = '9997'
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	642	"       and d.tingyongrq is null
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	643	"       and a.js_no = 0
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	644	"       and a.patient_No = in_patient_no;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	645	"  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	646	"    if length(v_temp) > 1 then
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	647	"      select curr_bed || '床,' || bah || v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	648	"        into v_temp
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	649	"        from zy_patient_information
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	650	"       where patient_no = in_patient_no;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	651	"    
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	652	"      Return v_temp;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	653	"    end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	654	"  
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	655	"  end if;
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	656	"  --限28天 end
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	657	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	658	"  --end end end 
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	659	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	660	"  Return '';
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	661	"
"
F_YB_ZNSHCL_ZY_JZXH	FUNCTION	662	"End;
"
