FUNC_YK_GETLASTJJ	FUNCTION	1	"FUNCTION         ""FUNC_YK_GETLASTJJ"" (p_ypxh   IN NUMBER,
"
FUNC_YK_GETLASTJJ	FUNCTION	2	"                                             p_ypcddm IN NUMBER)
"
FUNC_YK_GETLASTJJ	FUNCTION	3	"  RETURN NUMBER IS
"
FUNC_YK_GETLASTJJ	FUNCTION	4	"  RESULT NUMBER(16, 6);
"
FUNC_YK_GETLASTJJ	FUNCTION	5	"  v_kcxh NUMBER;
"
FUNC_YK_GETLASTJJ	FUNCTION	6	"  v_fzfl NUMBER;
"
FUNC_YK_GETLASTJJ	FUNCTION	7	"  v_ypbzl NUMBER;
"
FUNC_YK_GETLASTJJ	FUNCTION	8	"BEGIN
"
FUNC_YK_GETLASTJJ	FUNCTION	9	"  BEGIN
"
FUNC_YK_GETLASTJJ	FUNCTION	10	"  select fzfl into v_fzfl from gy_ypcdjg 
"
FUNC_YK_GETLASTJJ	FUNCTION	11	"         where ypxh = p_ypxh 
"
FUNC_YK_GETLASTJJ	FUNCTION	12	"         and ypcddm = p_ypcddm and bmxh is null;
"
FUNC_YK_GETLASTJJ	FUNCTION	13	"  
"
FUNC_YK_GETLASTJJ	FUNCTION	14	"    if v_fzfl is null then
"
FUNC_YK_GETLASTJJ	FUNCTION	15	"    SELECT MAX(kcxh)
"
FUNC_YK_GETLASTJJ	FUNCTION	16	"      INTO v_kcxh
"
FUNC_YK_GETLASTJJ	FUNCTION	17	"      FROM yk_ypkczb
"
FUNC_YK_GETLASTJJ	FUNCTION	18	"     WHERE ypxh = p_ypxh
"
FUNC_YK_GETLASTJJ	FUNCTION	19	"       AND ypcddm = p_ypcddm;
"
FUNC_YK_GETLASTJJ	FUNCTION	20	"       end if;
"
FUNC_YK_GETLASTJJ	FUNCTION	21	"    if v_fzfl is not null then
"
FUNC_YK_GETLASTJJ	FUNCTION	22	"     SELECT MAX(kcxh)
"
FUNC_YK_GETLASTJJ	FUNCTION	23	"      INTO v_kcxh
"
FUNC_YK_GETLASTJJ	FUNCTION	24	"      FROM yk_ypkczb
"
FUNC_YK_GETLASTJJ	FUNCTION	25	"     WHERE ypxh = v_fzfl
"
FUNC_YK_GETLASTJJ	FUNCTION	26	"       AND ypcddm = p_ypcddm;
"
FUNC_YK_GETLASTJJ	FUNCTION	27	"  /*EXCEPTION
"
FUNC_YK_GETLASTJJ	FUNCTION	28	"    WHEN no_data_found THEN
"
FUNC_YK_GETLASTJJ	FUNCTION	29	"      v_kcxh := 0;*/
"
FUNC_YK_GETLASTJJ	FUNCTION	30	"      end if;
"
FUNC_YK_GETLASTJJ	FUNCTION	31	"  END;
"
FUNC_YK_GETLASTJJ	FUNCTION	32	"
"
FUNC_YK_GETLASTJJ	FUNCTION	33	"  BEGIN
"
FUNC_YK_GETLASTJJ	FUNCTION	34	"  if v_fzfl is null then
"
FUNC_YK_GETLASTJJ	FUNCTION	35	"    SELECT jj
"
FUNC_YK_GETLASTJJ	FUNCTION	36	"      INTO RESULT
"
FUNC_YK_GETLASTJJ	FUNCTION	37	"      FROM yk_ypkczb
"
FUNC_YK_GETLASTJJ	FUNCTION	38	"     WHERE kcxh = v_kcxh
"
FUNC_YK_GETLASTJJ	FUNCTION	39	"       AND rownum = 1;
"
FUNC_YK_GETLASTJJ	FUNCTION	40	"       end if ;
"
FUNC_YK_GETLASTJJ	FUNCTION	41	"  if v_fzfl is not null then
"
FUNC_YK_GETLASTJJ	FUNCTION	42	"  select ypbzl into v_ypbzl from gy_ypcdjg
"
FUNC_YK_GETLASTJJ	FUNCTION	43	"         where ypxh = v_fzfl
"
FUNC_YK_GETLASTJJ	FUNCTION	44	"         and ypcddm = p_ypcddm and bmxh is null;
"
FUNC_YK_GETLASTJJ	FUNCTION	45	"      SELECT round(jj/v_ypbzl,2)
"
FUNC_YK_GETLASTJJ	FUNCTION	46	"      INTO RESULT
"
FUNC_YK_GETLASTJJ	FUNCTION	47	"      FROM yk_ypkczb
"
FUNC_YK_GETLASTJJ	FUNCTION	48	"     WHERE kcxh = v_kcxh
"
FUNC_YK_GETLASTJJ	FUNCTION	49	"       AND rownum = 1;
"
FUNC_YK_GETLASTJJ	FUNCTION	50	"       
"
FUNC_YK_GETLASTJJ	FUNCTION	51	"  /*EXCEPTION
"
FUNC_YK_GETLASTJJ	FUNCTION	52	"    WHEN no_data_found THEN
"
FUNC_YK_GETLASTJJ	FUNCTION	53	"      RESULT := NULL;*/
"
FUNC_YK_GETLASTJJ	FUNCTION	54	"      end if;
"
FUNC_YK_GETLASTJJ	FUNCTION	55	"  END;
"
FUNC_YK_GETLASTJJ	FUNCTION	56	"
"
FUNC_YK_GETLASTJJ	FUNCTION	57	"  RETURN(RESULT);
"
FUNC_YK_GETLASTJJ	FUNCTION	58	"END func_yk_getlastjj;
"
FUNC_YK_GETLASTJJ	FUNCTION	59	"
"
FUNC_YK_GETLASTJJ	FUNCTION	60	 
