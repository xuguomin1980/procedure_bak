FUN_GET_SWYH_CS	FUNCTION	1	"FUNCTION ""FUN_GET_SWYH_CS""(NO IN NUMBER) RETURN VARCHAR2 IS
"
FUN_GET_SWYH_CS	FUNCTION	2	"  RESULT VARCHAR2(100);
"
FUN_GET_SWYH_CS	FUNCTION	3	"  V_YYRS NUMBER(3);
"
FUN_GET_SWYH_CS	FUNCTION	4	"  V_GHRS NUMBER(3);
"
FUN_GET_SWYH_CS	FUNCTION	5	"
"
FUN_GET_SWYH_CS	FUNCTION	6	"BEGIN
"
FUN_GET_SWYH_CS	FUNCTION	7	"
"
FUN_GET_SWYH_CS	FUNCTION	8	"  BEGIN
"
FUN_GET_SWYH_CS	FUNCTION	9	"    SELECT COUNT(*)
"
FUN_GET_SWYH_CS	FUNCTION	10	"      INTO V_YYRS
"
FUN_GET_SWYH_CS	FUNCTION	11	"      FROM ZJHIS.GH_MZYYK A, ZJHIS.GH_MZPBK B
"
FUN_GET_SWYH_CS	FUNCTION	12	"     WHERE (A.PBXH = B.JLXH OR A.PBXH = B.PBJLXH)
"
FUN_GET_SWYH_CS	FUNCTION	13	"       AND TO_DATE(A.YYRQ1) = TO_DATE(B.RQ)
"
FUN_GET_SWYH_CS	FUNCTION	14	"       AND A.ZT = 0
"
FUN_GET_SWYH_CS	FUNCTION	15	"       AND A.YYSJ = 1
"
FUN_GET_SWYH_CS	FUNCTION	16	"       AND A.GHXH <= B.SWZGXH
"
FUN_GET_SWYH_CS	FUNCTION	17	"       AND B.JLXH = NO;
"
FUN_GET_SWYH_CS	FUNCTION	18	"  END;
"
FUN_GET_SWYH_CS	FUNCTION	19	"
"
FUN_GET_SWYH_CS	FUNCTION	20	"  BEGIN
"
FUN_GET_SWYH_CS	FUNCTION	21	"    SELECT COUNT(*)
"
FUN_GET_SWYH_CS	FUNCTION	22	"      INTO V_GHRS
"
FUN_GET_SWYH_CS	FUNCTION	23	"      FROM ZJHIS.GH_GHK
"
FUN_GET_SWYH_CS	FUNCTION	24	"     WHERE PBXH IN (SELECT JLXH FROM ZJHIS.GH_MZPBK WHERE JLXH = NO)
"
FUN_GET_SWYH_CS	FUNCTION	25	"       AND GHRQ > trunc(SYSDATE)
"
FUN_GET_SWYH_CS	FUNCTION	26	"       AND SJLB = 1
"
FUN_GET_SWYH_CS	FUNCTION	27	"       AND thbz = 0
"
FUN_GET_SWYH_CS	FUNCTION	28	"       AND nvl(zfpb, 0) = 0;
"
FUN_GET_SWYH_CS	FUNCTION	29	"  END;
"
FUN_GET_SWYH_CS	FUNCTION	30	"  BEGIN
"
FUN_GET_SWYH_CS	FUNCTION	31	"    SELECT NVL(A.swzgxh, 0) - V_YYRS - V_GHRS
"
FUN_GET_SWYH_CS	FUNCTION	32	"      INTO RESULT
"
FUN_GET_SWYH_CS	FUNCTION	33	"      from ZJHIS.GH_MZPBK A
"
FUN_GET_SWYH_CS	FUNCTION	34	"     WHERE A.jlxh = NO;
"
FUN_GET_SWYH_CS	FUNCTION	35	"  
"
FUN_GET_SWYH_CS	FUNCTION	36	"  EXCEPTION
"
FUN_GET_SWYH_CS	FUNCTION	37	"    --异常处理 未找到数据
"
FUN_GET_SWYH_CS	FUNCTION	38	"    WHEN NO_DATA_FOUND THEN
"
FUN_GET_SWYH_CS	FUNCTION	39	"    
"
FUN_GET_SWYH_CS	FUNCTION	40	"      --没有找到数据      
"
FUN_GET_SWYH_CS	FUNCTION	41	"      RESULT := null;
"
FUN_GET_SWYH_CS	FUNCTION	42	"    
"
FUN_GET_SWYH_CS	FUNCTION	43	"  END;
"
FUN_GET_SWYH_CS	FUNCTION	44	"  if RESULT >= 0 then
"
FUN_GET_SWYH_CS	FUNCTION	45	"    V_GHRS := 0;
"
FUN_GET_SWYH_CS	FUNCTION	46	"  else
"
FUN_GET_SWYH_CS	FUNCTION	47	"    SELECT COUNT(*)
"
FUN_GET_SWYH_CS	FUNCTION	48	"      INTO V_YYRS
"
FUN_GET_SWYH_CS	FUNCTION	49	"      FROM ZJHIS.GH_MZYYK A
"
FUN_GET_SWYH_CS	FUNCTION	50	"     WHERE TO_DATE(A.YYRQ1) > trunc(sysdate)
"
FUN_GET_SWYH_CS	FUNCTION	51	"       AND A.ZT = 0
"
FUN_GET_SWYH_CS	FUNCTION	52	"       AND A.YYSJ = 1
"
FUN_GET_SWYH_CS	FUNCTION	53	"       and A.PBXH = NO;
"
FUN_GET_SWYH_CS	FUNCTION	54	"    SELECT NVL(A.swzgxh, 0) - V_YYRS
"
FUN_GET_SWYH_CS	FUNCTION	55	"      INTO RESULT
"
FUN_GET_SWYH_CS	FUNCTION	56	"      from ZJHIS.GH_yzpbk A
"
FUN_GET_SWYH_CS	FUNCTION	57	"     WHERE A.jlxh = NO;
"
FUN_GET_SWYH_CS	FUNCTION	58	"  end if;
"
FUN_GET_SWYH_CS	FUNCTION	59	"
"
FUN_GET_SWYH_CS	FUNCTION	60	"  RETURN(RESULT);
"
FUN_GET_SWYH_CS	FUNCTION	61	"END FUN_GET_SWYH_CS;
"
