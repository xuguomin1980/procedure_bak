YK_DYPCQD	PROCEDURE	1	"PROCEDURE         ""YK_DYPCQD"" (
"
YK_DYPCQD	PROCEDURE	2	"        P_XTXH   IN NUMBER,
"
YK_DYPCQD	PROCEDURE	3	"        P_KFBZ	 IN NUMBER,
"
YK_DYPCQD	PROCEDURE	4	"	P_KJQJ   IN CHAR ) IS
"
YK_DYPCQD	PROCEDURE	5	"BEGIN
"
YK_DYPCQD	PROCEDURE	6	"DECLARE
"
YK_DYPCQD	PROCEDURE	7	"
"
YK_DYPCQD	PROCEDURE	8	"   V_YPXH	NUMBER(6);
"
YK_DYPCQD	PROCEDURE	9	"   V_YPCDDM     NUMBER(6);
"
YK_DYPCQD	PROCEDURE	10	"   V_YPMC	VARCHAR2(36);
"
YK_DYPCQD	PROCEDURE	11	"   V_YPGG	VARCHAR2(36);
"
YK_DYPCQD	PROCEDURE	12	"   V_CDMC	VARCHAR2(36);
"
YK_DYPCQD	PROCEDURE	13	"   V_GLXH	NUMBER(6);
"
YK_DYPCQD	PROCEDURE	14	"   V_GLMC	VARCHAR2(36);
"
YK_DYPCQD	PROCEDURE	15	"   V_PFJ	NUMBER(16,6);
"
YK_DYPCQD	PROCEDURE	16	"   V_LSJ	NUMBER(16,6);
"
YK_DYPCQD	PROCEDURE	17	"   V_KCS        NUMBER(14,4);
"
YK_DYPCQD	PROCEDURE	18	"   V_PYPKS      NUMBER(14,4);
"
YK_DYPCQD	PROCEDURE	19	"   V_ZBLB	NUMBER(2);
"
YK_DYPCQD	PROCEDURE	20	"   V_COUNT	NUMBER(6);
"
YK_DYPCQD	PROCEDURE	21	"   V_SRM1       VARCHAR2(8);
"
YK_DYPCQD	PROCEDURE	22	"
"
YK_DYPCQD	PROCEDURE	23	"     CURSOR CUR_YPKC IS 
"
YK_DYPCQD	PROCEDURE	24	"    SELECT YPXH,YPCDDM
"
YK_DYPCQD	PROCEDURE	25	"    FROM GY_YPCDJG WHERE KFBZ = P_KFBZ AND BMXH IS NULL AND SUBSTR(YPSX,10,1) = '0' 
"
YK_DYPCQD	PROCEDURE	26	"    ORDER BY YPXH,YPCDDM;
"
YK_DYPCQD	PROCEDURE	27	"
"
YK_DYPCQD	PROCEDURE	28	"BEGIN
"
YK_DYPCQD	PROCEDURE	29	"
"
YK_DYPCQD	PROCEDURE	30	"---- INIT
"
YK_DYPCQD	PROCEDURE	31	"     DELETE FROM YK_DYPCQD_TEMP WHERE XTXH = P_XTXH  ;
"
YK_DYPCQD	PROCEDURE	32	"
"
YK_DYPCQD	PROCEDURE	33	"
"
YK_DYPCQD	PROCEDURE	34	"---- START
"
YK_DYPCQD	PROCEDURE	35	"  OPEN CUR_YPKC;
"
YK_DYPCQD	PROCEDURE	36	"  LOOP
"
YK_DYPCQD	PROCEDURE	37	"       FETCH CUR_YPKC INTO V_YPXH,V_YPCDDM;
"
YK_DYPCQD	PROCEDURE	38	"       EXIT WHEN CUR_YPKC%NOTFOUND;
"
YK_DYPCQD	PROCEDURE	39	"
"
YK_DYPCQD	PROCEDURE	40	"       SELECT YPMC,YPGG,CDMC,PFJ,LSJ,ZBLB,SRM1
"
YK_DYPCQD	PROCEDURE	41	"       INTO V_YPMC,V_YPGG,V_CDMC,V_PFJ,V_LSJ,V_ZBLB,V_SRM1
"
YK_DYPCQD	PROCEDURE	42	"       FROM GY_YPCDJG
"
YK_DYPCQD	PROCEDURE	43	"       WHERE BMXH IS NULL AND YPXH = V_YPXH AND YPCDDM = V_YPCDDM AND KFBZ = P_KFBZ;
"
YK_DYPCQD	PROCEDURE	44	"
"
YK_DYPCQD	PROCEDURE	45	"      BEGIN
"
YK_DYPCQD	PROCEDURE	46	"       SELECT GLXH,GLMC INTO V_GLXH,V_GLMC
"
YK_DYPCQD	PROCEDURE	47	"       FROM GY_YPMCGGZD
"
YK_DYPCQD	PROCEDURE	48	"       WHERE YPXH = V_YPXH ;
"
YK_DYPCQD	PROCEDURE	49	"       EXCEPTION      
"
YK_DYPCQD	PROCEDURE	50	"	   WHEN NO_DATA_FOUND THEN
"
YK_DYPCQD	PROCEDURE	51	"           V_GLXH := 0;
"
YK_DYPCQD	PROCEDURE	52	"           V_GLMC := '´íÎó';
"
YK_DYPCQD	PROCEDURE	53	"      END;
"
YK_DYPCQD	PROCEDURE	54	"
"
YK_DYPCQD	PROCEDURE	55	"      BEGIN
"
YK_DYPCQD	PROCEDURE	56	"       SELECT SUM(NVL(KCS,0)) INTO V_KCS
"
YK_DYPCQD	PROCEDURE	57	"       FROM YK_YPKCZB
"
YK_DYPCQD	PROCEDURE	58	"       WHERE XTXH = P_XTXH AND YPXH = V_YPXH AND YPCDDM = V_YPCDDM;
"
YK_DYPCQD	PROCEDURE	59	"       EXCEPTION      
"
YK_DYPCQD	PROCEDURE	60	"	   WHEN NO_DATA_FOUND THEN
"
YK_DYPCQD	PROCEDURE	61	"           V_KCS := 0;
"
YK_DYPCQD	PROCEDURE	62	"      END;
"
YK_DYPCQD	PROCEDURE	63	"
"
YK_DYPCQD	PROCEDURE	64	"      BEGIN
"
YK_DYPCQD	PROCEDURE	65	"       SELECT  SUM(NVL(SL,0)) INTO V_PYPKS
"
YK_DYPCQD	PROCEDURE	66	"       FROM YK_YPMXZ
"
YK_DYPCQD	PROCEDURE	67	"       WHERE XTXH = P_XTXH AND YPXH = V_YPXH AND YPCDDM = V_YPCDDM 
"
YK_DYPCQD	PROCEDURE	68	"       AND CRKDH LIKE P_KJQJ||'%' AND CRKFSDM=22;
"
YK_DYPCQD	PROCEDURE	69	"       EXCEPTION      
"
YK_DYPCQD	PROCEDURE	70	"	   WHEN NO_DATA_FOUND THEN
"
YK_DYPCQD	PROCEDURE	71	"           V_PYPKS := 0;
"
YK_DYPCQD	PROCEDURE	72	"      END;
"
YK_DYPCQD	PROCEDURE	73	"
"
YK_DYPCQD	PROCEDURE	74	"      SELECT COUNT(*) INTO V_COUNT
"
YK_DYPCQD	PROCEDURE	75	"      FROM YK_DYPCQD_TEMP
"
YK_DYPCQD	PROCEDURE	76	"      WHERE XTXH = P_XTXH AND YPXH = V_YPXH AND YPCDDM = V_YPCDDM;
"
YK_DYPCQD	PROCEDURE	77	" 
"
YK_DYPCQD	PROCEDURE	78	"      IF V_COUNT = 0 THEN
"
YK_DYPCQD	PROCEDURE	79	"
"
YK_DYPCQD	PROCEDURE	80	"      INSERT INTO YK_DYPCQD_TEMP 
"
YK_DYPCQD	PROCEDURE	81	"      (XTXH,YPXH,YPCDDM,YPMC,YPGG,CDMC,GLXH,GLMC,PFJ,LSJ,KCS,PYPKS,ZBLB,SRM1)  
"
YK_DYPCQD	PROCEDURE	82	"      VALUES(P_XTXH,V_YPXH,V_YPCDDM,V_YPMC,V_YPGG,V_CDMC,V_GLXH,
"
YK_DYPCQD	PROCEDURE	83	"      V_GLMC,V_PFJ,V_LSJ,V_KCS,V_PYPKS,V_ZBLB,V_SRM1);
"
YK_DYPCQD	PROCEDURE	84	"      END IF;
"
YK_DYPCQD	PROCEDURE	85	"      
"
YK_DYPCQD	PROCEDURE	86	"      V_PYPKS := 0;
"
YK_DYPCQD	PROCEDURE	87	"   END LOOP;
"
YK_DYPCQD	PROCEDURE	88	"   CLOSE CUR_YPKC;
"
YK_DYPCQD	PROCEDURE	89	"
"
YK_DYPCQD	PROCEDURE	90	"--COMMIT;
"
YK_DYPCQD	PROCEDURE	91	"
"
YK_DYPCQD	PROCEDURE	92	"EXCEPTION  -- exception handlers begin
"
YK_DYPCQD	PROCEDURE	93	"   WHEN NO_DATA_FOUND THEN
"
YK_DYPCQD	PROCEDURE	94	"        ROLLBACK;
"
YK_DYPCQD	PROCEDURE	95	"	RAISE_APPLICATION_ERROR(-20102,'YK_DYPCQD NO_DATA_FOUND');
"
YK_DYPCQD	PROCEDURE	96	"
"
YK_DYPCQD	PROCEDURE	97	"   WHEN OTHERS THEN  -- handles all other errors
"
YK_DYPCQD	PROCEDURE	98	"        ROLLBACK;
"
YK_DYPCQD	PROCEDURE	99	"	RAISE_APPLICATION_ERROR(-20103,'YK_DYPCQD FAILS');
"
YK_DYPCQD	PROCEDURE	100	"END;
"
YK_DYPCQD	PROCEDURE	101	"END;
"
YK_DYPCQD	PROCEDURE	102	"
"
YK_DYPCQD	PROCEDURE	103	"
"
YK_DYPCQD	PROCEDURE	104	"
"
YK_DYPCQD	PROCEDURE	105	 
