YK_FPHMCX_HM	PROCEDURE	1	"PROCEDURE         ""YK_FPHMCX_HM"" (
"
YK_FPHMCX_HM	PROCEDURE	2	"        P_XTXH   IN NUMBER,
"
YK_FPHMCX_HM	PROCEDURE	3	"        P_FPHM   IN CHAR,
"
YK_FPHMCX_HM	PROCEDURE	4	"        P_CXFS   IN NUMBER,  
"
YK_FPHMCX_HM	PROCEDURE	5	"        P_RQ1	 IN CHAR,
"
YK_FPHMCX_HM	PROCEDURE	6	"        P_RQ2    IN CHAR) IS
"
YK_FPHMCX_HM	PROCEDURE	7	"BEGIN
"
YK_FPHMCX_HM	PROCEDURE	8	"DECLARE
"
YK_FPHMCX_HM	PROCEDURE	9	"        V_YPCDDM  NUMBER(8);
"
YK_FPHMCX_HM	PROCEDURE	10	"        V_YPXH    NUMBER(6);
"
YK_FPHMCX_HM	PROCEDURE	11	"        V_RKDH    CHAR(8);
"
YK_FPHMCX_HM	PROCEDURE	12	"        V_JZRD    DATE;
"
YK_FPHMCX_HM	PROCEDURE	13	"        V_PFJ     NUMBER(16,6);
"
YK_FPHMCX_HM	PROCEDURE	14	"        V_JJ      NUMBER(16,6);
"
YK_FPHMCX_HM	PROCEDURE	15	"        V_LSJ     NUMBER(16,6);
"
YK_FPHMCX_HM	PROCEDURE	16	"        V_RKSL    NUMBER(16,6);
"
YK_FPHMCX_HM	PROCEDURE	17	"        V_CRKFSDM NUMBER(2);
"
YK_FPHMCX_HM	PROCEDURE	18	"        V_KL      NUMBER(4,2);
"
YK_FPHMCX_HM	PROCEDURE	19	"        V_ZBLB    NUMBER(2);
"
YK_FPHMCX_HM	PROCEDURE	20	"        V_FPHM    VARCHAR2(10);
"
YK_FPHMCX_HM	PROCEDURE	21	"	V_JGXH	  NUMBER;
"
YK_FPHMCX_HM	PROCEDURE	22	"
"
YK_FPHMCX_HM	PROCEDURE	23	"CURSOR CUR_FPHMCX_HM IS 
"
YK_FPHMCX_HM	PROCEDURE	24	"     SELECT A.YPXH,A.YPCDDM,A.CRKFSDM,A.RKDH,B.JZRQ,A.PFJ,A.JJ,A.LSJ,A.RKSL,A.KL,A.ZBLB,A.FPHM,A.JGXH
"
YK_FPHMCX_HM	PROCEDURE	25	"     FROM YK_YPRKDMX A ,YK_YPRKD B
"
YK_FPHMCX_HM	PROCEDURE	26	"     WHERE LTRIM(RTRIM(A.FPHM)) LIKE P_FPHM AND B.XTXH=A.XTXH AND A.XTXH=P_XTXH
"
YK_FPHMCX_HM	PROCEDURE	27	"           AND B.RKDH=A.RKDH AND A.CRKFSDM=B.CRKFSDM AND B.JZRQ>=TO_DATE(P_RQ1,'YYYY-MM-DD') 
"
YK_FPHMCX_HM	PROCEDURE	28	"           AND B.JZRQ <TO_DATE(P_RQ2,'YYYY-MM-DD') AND A.YDZBZ = 1;
"
YK_FPHMCX_HM	PROCEDURE	29	"
"
YK_FPHMCX_HM	PROCEDURE	30	"CURSOR CUR_FPHMCX_HM2 IS 
"
YK_FPHMCX_HM	PROCEDURE	31	"     SELECT A.YPXH,A.YPCDDM,A.CRKFSDM,A.RKDH,B.JZRQ,A.PFJ,A.JJ,A.LSJ,A.RKSL,A.KL,A.ZBLB,A.JGXH
"
YK_FPHMCX_HM	PROCEDURE	32	"     FROM YK_YPRKDMX A ,YK_YPRKD B
"
YK_FPHMCX_HM	PROCEDURE	33	"     WHERE LTRIM(RTRIM(A.FPHM)) = P_FPHM AND B.XTXH=A.XTXH AND A.XTXH=P_XTXH
"
YK_FPHMCX_HM	PROCEDURE	34	"           AND B.RKDH=A.RKDH AND A.CRKFSDM=B.CRKFSDM AND B.JZRQ>=TO_DATE(P_RQ1,'YYYY-MM-DD') 
"
YK_FPHMCX_HM	PROCEDURE	35	"           AND B.JZRQ <TO_DATE(P_RQ2,'YYYY-MM-DD') AND A.YDZBZ = 1;
"
YK_FPHMCX_HM	PROCEDURE	36	"
"
YK_FPHMCX_HM	PROCEDURE	37	"BEGIN
"
YK_FPHMCX_HM	PROCEDURE	38	"DELETE FROM YK_FPHMCX_TEMP WHERE XTXH = P_XTXH;
"
YK_FPHMCX_HM	PROCEDURE	39	"IF P_CXFS=1 THEN
"
YK_FPHMCX_HM	PROCEDURE	40	"   BEGIN 
"
YK_FPHMCX_HM	PROCEDURE	41	"	    OPEN CUR_FPHMCX_HM;
"
YK_FPHMCX_HM	PROCEDURE	42	"	LOOP
"
YK_FPHMCX_HM	PROCEDURE	43	"	      FETCH CUR_FPHMCX_HM INTO V_YPXH,V_YPCDDM,V_CRKFSDM,V_RKDH,V_JZRD,V_PFJ,V_JJ,V_LSJ,V_RKSL,V_KL,V_ZBLB,V_FPHM,V_JGXH;
"
YK_FPHMCX_HM	PROCEDURE	44	"	      EXIT WHEN CUR_FPHMCX_HM%NOTFOUND;
"
YK_FPHMCX_HM	PROCEDURE	45	"        
"
YK_FPHMCX_HM	PROCEDURE	46	"             INSERT INTO YK_FPHMCX_TEMP(XTXH,JGXH,YPXH,YPCDDM,FPHM,RKDH,CRKFSDM,JZRQ,RKSL,JJ,PFJ,LSJ,KL,ZBLB)
"
YK_FPHMCX_HM	PROCEDURE	47	"             VALUES(P_XTXH,V_JGXH,V_YPXH,V_YPCDDM,V_FPHM, V_RKDH,V_CRKFSDM,V_JZRD,V_RKSL,V_JJ,V_PFJ,V_LSJ,V_KL,V_ZBLB);      
"
YK_FPHMCX_HM	PROCEDURE	48	"      
"
YK_FPHMCX_HM	PROCEDURE	49	"
"
YK_FPHMCX_HM	PROCEDURE	50	"        END LOOP;
"
YK_FPHMCX_HM	PROCEDURE	51	"    CLOSE CUR_FPHMCX_HM;
"
YK_FPHMCX_HM	PROCEDURE	52	"   END;
"
YK_FPHMCX_HM	PROCEDURE	53	"ELSE 
"
YK_FPHMCX_HM	PROCEDURE	54	"        BEGIN 
"
YK_FPHMCX_HM	PROCEDURE	55	"	    OPEN CUR_FPHMCX_HM2;
"
YK_FPHMCX_HM	PROCEDURE	56	"	LOOP
"
YK_FPHMCX_HM	PROCEDURE	57	"	      FETCH CUR_FPHMCX_HM2 INTO V_YPXH,V_YPCDDM,V_CRKFSDM,V_RKDH,V_JZRD,V_PFJ,V_JJ,V_LSJ,V_RKSL,V_KL,V_ZBLB,V_JGXH;
"
YK_FPHMCX_HM	PROCEDURE	58	"	      EXIT WHEN CUR_FPHMCX_HM2%NOTFOUND;
"
YK_FPHMCX_HM	PROCEDURE	59	"       
"
YK_FPHMCX_HM	PROCEDURE	60	"             INSERT INTO YK_FPHMCX_TEMP(XTXH,JGXH,YPXH,YPCDDM,FPHM,RKDH,CRKFSDM,JZRQ,RKSL,JJ,PFJ,LSJ,KL,ZBLB)
"
YK_FPHMCX_HM	PROCEDURE	61	"             VALUES(P_XTXH,V_JGXH,V_YPXH,V_YPCDDM,P_FPHM, V_RKDH,V_CRKFSDM,V_JZRD,V_RKSL,V_JJ,V_PFJ,V_LSJ,V_KL,V_ZBLB);      
"
YK_FPHMCX_HM	PROCEDURE	62	"       
"
YK_FPHMCX_HM	PROCEDURE	63	"        END LOOP;
"
YK_FPHMCX_HM	PROCEDURE	64	"          CLOSE CUR_FPHMCX_HM2;
"
YK_FPHMCX_HM	PROCEDURE	65	"   END;
"
YK_FPHMCX_HM	PROCEDURE	66	"END IF;
"
YK_FPHMCX_HM	PROCEDURE	67	"
"
YK_FPHMCX_HM	PROCEDURE	68	"
"
YK_FPHMCX_HM	PROCEDURE	69	"EXCEPTION  -- exception handlers begin
"
YK_FPHMCX_HM	PROCEDURE	70	"   WHEN OTHERS THEN  -- handles all other errors
"
YK_FPHMCX_HM	PROCEDURE	71	"        ROLLBACK;
"
YK_FPHMCX_HM	PROCEDURE	72	"	RAISE_APPLICATION_ERROR(-20103,'YK_FPHMCX_HM FAILS');
"
YK_FPHMCX_HM	PROCEDURE	73	"END;
"
YK_FPHMCX_HM	PROCEDURE	74	"END;
"
YK_FPHMCX_HM	PROCEDURE	75	"
"
YK_FPHMCX_HM	PROCEDURE	76	"
"
YK_FPHMCX_HM	PROCEDURE	77	"
"
YK_FPHMCX_HM	PROCEDURE	78	 
